#
d0$irF=ifelse(is.na(d0$praeirF),0, ifelse(d0$praeirF,2,1))#
#
d0$cnt2=as.factor(ifelse(d0$cnt>2,3,d0$cnt))#
#
library(lattice)#
#
#
bwplot(EZDZerfall~cnt2|indikation,data=d0[d0$ir==0,])#
t.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
summary(coxph (Surv(kmz_years,kms)~cnt+irF+trepan , data=d0))
summary(d0)
t.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='KK' & d0$cnt<3,])
d0=read.table('/Users/boehringer/Documents/science2/rekp/stat/gesamtliste2.txt', header = TRUE, sep = "\t",)#
#
d0$kmz_years=d0$zeitTrueb/365#
d0$kms=d0$trueb>0#
#
d0$praeirF=d0$praeir>0#
d0[d0$cnt>1 & is.na(d0$praeir),]$praeirF=FALSE #
#
d0$irF=ifelse(is.na(d0$praeirF),0, ifelse(d0$praeirF,2,1))#
#
d0$cnt2=as.factor(ifelse(d0$cnt>2,3,d0$cnt))#
#
library(lattice)#
#
#
bwplot(EZDZerfall~cnt2|indikation,data=d0[d0$ir==0,])#
t.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
boxplot(d0$EZDZerfall, d0$praeezd)
boxplot(d0$EZDZerfall)
boxplot(d0$EZDZerfall, d0$praeezd)
t.test(d0$EZDZerfall, d0$praeezd, method='paired')
?t.test
t.test(d0$EZDZerfall, d0$praeezd, paired=TRUE)
d0=read.table('/Users/boehringer/Documents/science2/rekp/stat/gesamtliste2.txt', header = TRUE, sep = "\t",)#
#
d0$kmz_years=d0$zeitTrueb/365#
d0$kms=d0$trueb>0#
#
d0$praeirF=d0$praeir>0#
d0[d0$cnt>1 & is.na(d0$praeir),]$praeirF=FALSE #
d0$irF=ifelse(is.na(d0$praeirF),0, ifelse(d0$praeirF,2,1))#
d0$cnt2=as.factor(ifelse(d0$cnt>2,3,d0$cnt))#
#
library(lattice)#
#
boxplot(d0$EZDZerfall, d0$praeezd)#
bwplot(EZDZerfall~cnt2|indikation,data=d0[d0$ir==0,])#
t.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
boxplot(d0$EZDZerfall, d0$praeezd)
t.test(d0$EZDZerfall, d0$praeezd, paired=TRUE)
d0=read.table('/Users/boehringer/Documents/science2/rekp/stat/gesamtliste2.txt', header = TRUE, sep = "\t",)#
#
d0$kmz_years=d0$zeitTrueb/365#
d0$kms=d0$trueb>0#
#
d0$praeirF=d0$praeir>0#
d0[d0$cnt>1 & is.na(d0$praeir),]$praeirF=FALSE #
d0$irF=ifelse(is.na(d0$praeirF),0, ifelse(d0$praeirF,2,1))#
d0$cnt2=as.factor(ifelse(d0$cnt>2,3,d0$cnt))#
#
library(lattice)#
#
boxplot(d0$EZDZerfall, d0$praeezd)
summary(coxph (Surv(kmz_years,kms)~cnt+trepan , data=d0))
d0=read.table('/Users/boehringer/Documents/science2/rekp/stat/gesamtliste2.txt', header = TRUE, sep = "\t",)#
#
d0$kmz_years=d0$zeitTrueb/365#
d0$kms=d0$trueb>0#
#
d0$praeirF=d0$praeir>0#
d0[d0$cnt>1 & is.na(d0$praeir),]$praeirF=FALSE #
d0$irF=ifelse(is.na(d0$praeirF),0, ifelse(d0$praeirF,2,1))#
d0$cnt2=as.factor(ifelse(d0$cnt>2,3,d0$cnt))#
#
library(lattice)#
#
boxplot(d0$EZDZerfall, d0$praeezd)
summary(coxph (Surv(kmz_years,kms)~cnt+trepan , data=d0))
d0$irF=as.factor( ifelse(is.na(d0$praeirF),0, ifelse(d0$praeirF,2,1)))
summary(coxph (Surv(kmz_years,kms)~cnt+irF+trepan , data=d0))
summary(coxph (Surv(kmz_years,kms)~irF+trepan , data=d0))
bwplot(EZDZerfall~cnt2|indikation,data=d0[d0$ir==0,])
t.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='KK' & d0$cnt<3,])
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='FD' & d0$cnt<3,])
plot (survfit(Surv(kmz_years,kms)~ irF, data=d0));
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='KK' & d0$cnt<3,])
boxplot(d0$EZDZerfall, d0$praeezd)
t.test(d0$EZDZerfall, d0$praeezd, paired=TRUE)
kruskal.test(d0$EZDZerfall, d0$praeezd, paired=TRUE)
?kruskal.test
d0$diffezd=d0$EZDZerfall-d0$praeezd
bwplot(diffezd ~indikation,data=d0[d0$ir==0,])
library(prettyR)
brkdn(diffezd ~indikation,data=d0[d0$ir==0,])
bwplot(EZDZerfall~ irF |indikation,data=d0[d0$ir==0,])
brkdn(EZDZerfall~ irF |indikation,data=d0[d0$ir==0,])
kruskal.test(EZDZerfall~cnt2, data=d0[d0$ir==0 & d0$indikation=='BKP' & d0$cnt<3,])
10/70
38/56
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/visus.txt")
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/visus.txt+")
melt(d0,id.vars=c(ID,E))
melt(d0,id.vars=c("ID","E"))
d1=melt(d0,id.vars=c("ID","E"))
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/visus.txt")#
#
d1=melt(d0,id.vars=c("ID","E"))#
write.table(d1,"/Users/boehringer/Documents/Dienstleistung/bredow/epilens/visus2.txt", sep = "\t", row.names=F, quote=F, na="", append = F, dec = ",")
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/visus2.txt", dec=",")
d0
library(ggplot2)
qplot(variable, value, geom="point", data=d0)
qplot(variable, value, geom="jitter", data=d0)
qplot(variable, value, geom=c("jitter","line"), data=d0)
qplot(variable, value, geom=c("point","line"), data=d0)
qplot(variable, value, geom=c("line"), data=d0)
qplot(variable, value, geom="jitter", data=d0)
qplot(variable, value, geom="boxplot", data=d0)
qplot(factor(variable), value, geom="boxplot", data=d0)
qplot(factor(variable), -log10(value), geom="boxplot", data=d0)
qplot(factor(variable), log10(value), geom="boxplot", data=d0)
qplot(factor(variable), log10(value), geom="boxplot", data=d0, xlab="Monate seit OP", ylab="Minus logMAR")
#
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/se")#
#
d1=melt(d0)#
write.table(d1,"/Users/boehringer/Documents/Dienstleistung/bredow/epilens/se2.txt", sep = "\t", row.names=F, quote=F, na="", append = F, dec = ",")
qplot(factor(variable), value, geom="boxplot", data=d0, xlab="Monate seit OP", ylab="Spaerisches Equivalent")
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/se2.txt", dec=",")#
#
library(ggplot2)#
qplot(factor(variable), value, geom="boxplot", data=d0, xlab="Monate seit OP", ylab="Spaerisches Equivalent")
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/ast")#
#
d1=melt(d0)#
write.table(d1,"/Users/boehringer/Documents/Dienstleistung/bredow/epilens/ast2.txt", sep = "\t", row.names=F, quote=F, na="", append = F, dec = ",")
qplot(factor(variable), value, geom="boxplot", data=d0, xlab="Monate seit OP", ylab="Astigmatismus")
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/bredow/epilens/ast2.txt", dec=",")#
#
qplot(factor(variable), value, geom="boxplot", data=d0, xlab="Monate seit OP", ylab="Astigmatismus")
power.t.test(n=NULL, delta=5, sd=6, sig.level=0.05, power=0.8, type=c("two.sample"))
power.t.test(n=20, delta=0.1, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.01, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.01, sd=1.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.00001, sd=1.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.0, sd=1.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.0, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.0, sd=0.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.0, sd=0.1, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.0, sd=0.00001, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=0.0, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=10.0, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
? power.t.test
power.t.test(n=20, delta=0.0, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=200, delta=0.0, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=1000, delta=0.0, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=1000, delta=0.01, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=1000, delta=1.01, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=10, delta=1.01, sd=2.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=100, delta=0.01, sd=0.00000000008, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=100, delta=0.01, sd=0.0000008, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=100, delta=0.01, sd=1.8, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=100, delta=0.01, sd=2.2, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=1.01, sd=2.2, sig.level=0.05, power=NULL, type=c("two.sample"))
power.t.test(n=20, delta=2.01, sd=2.2, sig.level=0.05, power=NULL, type=c("two.sample"))
library(ggplot2)#
library(Hmisc)#
library(gdata)#
### fuer poster#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090909.txt')#
d2$logMAR=-log(d2$bcva, base=10)#
d2$MinusLogMAR=log(d2$bcva, base=10)#
d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k= -d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k#
d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm = -d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm#
#
#
d3=subset(d2, indikation %in% c("FD", "BK", "KK") & (hh_ring=="" | hh_ring=="0") & !(faeden %in% c("","0") ) & profile!='GTS' )#
d3=subset(d2, profile!='GTS' )#
d3$profile=drop.levels(d3$profile)#
#
print(summary(profile~ indikation+irreg+cyl_k+kera3mm+ MinusLogMAR +faeden+monthspostop+nahttechnik, method="reverse", test=T , pctdig=2, data=d3), prmsd=T)#
#theme_set(theme_grey(base_size = 20))#
pdf('/Users/boehringer/Desktop/ausw_bir.pdf', pointsize=16)#
qplot(profile, irreg, geom=c("boxplot"), data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("irreg","profile","faeden"))), xlab="", facets=faeden~., colour= profile, ylab="Irregularitätsindex 3mm-Zone (Orbscan)")#
qplot(profile, cyl_k, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("cyl_k","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Simulierter Hornhautastigmatismus (Orbscan)", colour= profile)#
qplot(profile, kera3mm, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("kera3mm","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Hornhautastigmatismus 3mm-Zone (Orbscan)", colour= profile)#
qplot(profile, MinusLogMAR, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("MinusLogMAR","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Bestkorrigierte Sehschärfe (-logMAR)", colour= profile)#
dev.off()#
#
library(plyr)#
max_cyl <- function(df) max(df$kera3mm, na.rm=TRUE)#
min_cyl <- function(df) min(df$kera3mm, na.rm=TRUE)#
ddply(d3, .(profile), .drop=T, c("min_cyl","max_cyl"))#
#
#
by(subset(d3, select=c("kera3mm","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden~ kera3mm , method="reverse", test=T, digits=3 , data=x) #
} )#
#
by(subset(d3, select=c("cyl_k","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden~ cyl_k , method="reverse", test=T , pctdig=2, data=x)#
} )#
#
by(subset(d3, select=c("irreg","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden ~ irreg , method="reverse", test=T , pctdig=2, data=x)#
} )#
#
by(subset(d3, select=c("logMAR","faeden")),d3$profile, FUN=function(x)#
{	by(x,x$faeden, FUN=function(x) data.frame(n=length(x$faeden), mean=mean(x$logMAR)))#
} )#
#
by(d3,d3$profile, FUN=function(x) data.frame(sd=sd(x$kera3mm), mean=mean(x$kera3mm), min=min(x$kera3mm), max=max(x$kera3mm)))#
#
source('/Users/boehringer/src/Rprivate/fancy_plot_surv.R')#
#
pdf('/Users/boehringer/Desktop/irs.pdf', pointsize=18)#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~gruppe+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung", xmax=365)#
dev.off()#
#
#
#
#
#
#
#
#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/heinzelmann/fuchssurv.txt')#
source('/Users/boehringer/src/Rprivate/fancy_plot_surv.R')#
d2=subset(d2, KaplanMeierZeit>0)#
d2$Gruppe=as.factor(d2$group)#
levels(d2$Gruppe)=c("pKp","DSAEK")#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~ Gruppe, data=d2), xlab="Tage seit Operation", ylab="Anteil ohne Transplantatversagung und Abstoßung" )#
#
#
#
#
#
#
d0=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090908.txt')#
library(ggplot2)#
library(Hmisc)#
library(car)#
#
d0[!is.na(d0$cyl_k) & d0$cyl_k>0,]$cyl_k= -d0[!is.na(d0$cyl_k) & d0$cyl_k>0,]$cyl_k#
d0[!is.na(d0$kera3mm) & d0$kera3mm >0,]$kera3mm = -d0[!is.na(d0$kera3mm) & d0$kera3mm >0,]$kera3mm#
#
d1=subset(d0, monthspostop>=0 & monthspostop< 12 & indikation %in% c("FD", "BK", "KK") & (hh_ring=="" | hh_ring=="0"))#
d1$x=cut2(d1$monthspostop,c(0,2,5,11))#
levels(d1$x)=c("Quartal 1", "Quartal 2","Quartale 3-4")#
#
d1$x2=cut2(d1$monthspostop,c(0,5))#
levels(d1$x2)=c("Monate 1-6", "Ab Monat 7")#
#
d1$logMAR=-log(d1$bcva, base=10)#
#
pdf('/Users/boehringer/Desktop/ausw_bir_visus.pdf', pointsize=16)#
qplot(x, logMAR, geom="boxplot", data=na.omit(subset(d1, select=c("logMAR","x","gruppe","indikation"))), xlab="Postoperative Zeit", colour= gruppe , facets=indikation~., ylim=c(0,2))#
dev.off()
library(ggplot2)#
library(Hmisc)#
library(gdata)#
### fuer poster#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090909.txt')#
d2$logMAR=-log(d2$bcva, base=10)#
d2$MinusLogMAR=log(d2$bcva, base=10)#
d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k= -d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k#
d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm = -d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm
summary(d2)
levels(d2$cyl_r)
library(ggplot2)#
library(Hmisc)#
library(gdata)#
### fuer poster#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090909.txt')#
d2$logMAR=-log(d2$bcva, base=10)#
d2$MinusLogMAR=log(d2$bcva, base=10)#
d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k= -d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k#
d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm = -d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm
d3=subset(d2, indikation %in% c("FD", "BK", "KK") & (hh_ring=="" | hh_ring=="0") & !(faeden %in% c("","0") ) & profile!='GTS' )#
d3=subset(d2, profile!='GTS' )#
d3$profile=drop.levels(d3$profile)#
#
print(summary(profile~ indikation+irreg+cyl_k+kera3mm+ MinusLogMAR +faeden+monthspostop+nahttechnik, method="reverse", test=T , pctdig=2, data=d3), prmsd=T)#
#theme_set(theme_grey(base_size = 20))#
pdf('/Users/boehringer/Desktop/ausw_bir.pdf', pointsize=16)#
qplot(profile, irreg, geom=c("boxplot"), data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("irreg","profile","faeden"))), xlab="", facets=faeden~., colour= profile, ylab="Irregularitätsindex 3mm-Zone (Orbscan)")#
qplot(profile, cyl_k, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("cyl_k","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Simulierter Hornhautastigmatismus (Orbscan)", colour= profile)#
qplot(profile, kera3mm, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("kera3mm","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Hornhautastigmatismus 3mm-Zone (Orbscan)", colour= profile)#
qplot(profile, MinusLogMAR, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("1","2","EKN"), select=c("MinusLogMAR","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Bestkorrigierte Sehschärfe (-logMAR)", colour= profile)#
dev.off()#
#
library(plyr)#
max_cyl <- function(df) max(df$kera3mm, na.rm=TRUE)#
min_cyl <- function(df) min(df$kera3mm, na.rm=TRUE)#
ddply(d3, .(profile), .drop=T, c("min_cyl","max_cyl"))#
#
#
by(subset(d3, select=c("kera3mm","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden~ kera3mm , method="reverse", test=T, digits=3 , data=x) #
} )#
#
by(subset(d3, select=c("cyl_k","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden~ cyl_k , method="reverse", test=T , pctdig=2, data=x)#
} )#
#
by(subset(d3, select=c("irreg","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden ~ irreg , method="reverse", test=T , pctdig=2, data=x)#
} )#
#
by(subset(d3, select=c("logMAR","faeden")),d3$profile, FUN=function(x)#
{	by(x,x$faeden, FUN=function(x) data.frame(n=length(x$faeden), mean=mean(x$logMAR)))#
} )#
#
by(d3,d3$profile, FUN=function(x) data.frame(sd=sd(x$kera3mm), mean=mean(x$kera3mm), min=min(x$kera3mm), max=max(x$kera3mm)))#
#
source('/Users/boehringer/src/Rprivate/fancy_plot_surv.R')#
#
pdf('/Users/boehringer/Desktop/irs.pdf', pointsize=18)#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~gruppe+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung", xmax=365)#
dev.off()#
#
#
#
#
#
#
#
#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/heinzelmann/fuchssurv.txt')#
source('/Users/boehringer/src/Rprivate/fancy_plot_surv.R')#
d2=subset(d2, KaplanMeierZeit>0)#
d2$Gruppe=as.factor(d2$group)#
levels(d2$Gruppe)=c("pKp","DSAEK")#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~ Gruppe, data=d2), xlab="Tage seit Operation", ylab="Anteil ohne Transplantatversagung und Abstoßung" )#
#
#
#
#
#
#
d0=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090908.txt')#
library(ggplot2)#
library(Hmisc)#
library(car)#
#
d0[!is.na(d0$cyl_k) & d0$cyl_k>0,]$cyl_k= -d0[!is.na(d0$cyl_k) & d0$cyl_k>0,]$cyl_k#
d0[!is.na(d0$kera3mm) & d0$kera3mm >0,]$kera3mm = -d0[!is.na(d0$kera3mm) & d0$kera3mm >0,]$kera3mm#
#
d1=subset(d0, monthspostop>=0 & monthspostop< 12 & indikation %in% c("FD", "BK", "KK") & (hh_ring=="" | hh_ring=="0"))#
d1$x=cut2(d1$monthspostop,c(0,2,5,11))#
levels(d1$x)=c("Quartal 1", "Quartal 2","Quartale 3-4")#
#
d1$x2=cut2(d1$monthspostop,c(0,5))#
levels(d1$x2)=c("Monate 1-6", "Ab Monat 7")#
#
d1$logMAR=-log(d1$bcva, base=10)#
#
pdf('/Users/boehringer/Desktop/ausw_bir_visus.pdf', pointsize=16)#
qplot(x, logMAR, geom="boxplot", data=na.omit(subset(d1, select=c("logMAR","x","gruppe","indikation"))), xlab="Postoperative Zeit", colour= gruppe , facets=indikation~., ylim=c(0,2))#
dev.off()
summary(d2)
subset(d2, kera3mm<(-400))
library(ggplot2)#
library(Hmisc)#
library(gdata)#
### fuer poster#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090909.txt')#
d2$logMAR=-log(d2$bcva, base=10)#
d2$MinusLogMAR=log(d2$bcva, base=10)#
d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k= -d2[!is.na(d2$cyl_k) & d2$cyl_k>0,]$cyl_k#
d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm = -d2[!is.na(d2$kera3mm) & d2$kera3mm >0,]$kera3mm#
#
#
d3=subset(d2, indikation %in% c("FD", "BK", "KK") & (hh_ring=="" | hh_ring=="0") & !(faeden %in% c("","0") ) & profile!='GTS' )#
d3=subset(d2, profile!='GTS' )#
d3$profile=drop.levels(d3$profile)#
#
print(summary(profile~ indikation+irreg+cyl_k+kera3mm+ MinusLogMAR +faeden+monthspostop+nahttechnik, method="reverse", test=T , pctdig=2, data=d3), prmsd=T)#
#theme_set(theme_grey(base_size = 20))#
pdf('/Users/boehringer/Desktop/ausw_bir.pdf', pointsize=16)#
qplot(profile, irreg, geom=c("boxplot"), data=na.omit(subset(d3, faeden %in% c("0","1","2","EKN"), select=c("irreg","profile","faeden"))), xlab="", facets=faeden~., colour= profile, ylab="Irregularitätsindex 3mm-Zone (Orbscan)")#
qplot(profile, cyl_k, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("0","1","2","EKN"), select=c("cyl_k","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Simulierter Hornhautastigmatismus (Orbscan)", colour= profile)#
qplot(profile, kera3mm, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("0","1","2","EKN"), select=c("kera3mm","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Hornhautastigmatismus 3mm-Zone (Orbscan)", colour= profile)#
qplot(profile, MinusLogMAR, geom="boxplot", data=na.omit(subset(d3, faeden %in% c("0","1","2","EKN"), select=c("MinusLogMAR","profile","faeden","indikation"))), xlab="", facets=faeden~ ., ylab="Bestkorrigierte Sehschärfe (-logMAR)", colour= profile)#
dev.off()#
#
library(plyr)#
max_cyl <- function(df) max(df$kera3mm, na.rm=TRUE)#
min_cyl <- function(df) min(df$kera3mm, na.rm=TRUE)#
ddply(d3, .(profile), .drop=T, c("min_cyl","max_cyl"))#
#
#
by(subset(d3, select=c("kera3mm","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden~ kera3mm , method="reverse", test=T, digits=3 , data=x) #
} )#
#
by(subset(d3, select=c("cyl_k","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden~ cyl_k , method="reverse", test=T , pctdig=2, data=x)#
} )#
#
by(subset(d3, select=c("irreg","faeden")),d3$profile, FUN=function(x)#
{	summary( faeden ~ irreg , method="reverse", test=T , pctdig=2, data=x)#
} )#
#
by(subset(d3, select=c("logMAR","faeden")),d3$profile, FUN=function(x)#
{	by(x,x$faeden, FUN=function(x) data.frame(n=length(x$faeden), mean=mean(x$logMAR)))#
} )#
#
by(d3,d3$profile, FUN=function(x) data.frame(sd=sd(x$kera3mm), mean=mean(x$kera3mm), min=min(x$kera3mm), max=max(x$kera3mm)))#
#
source('/Users/boehringer/src/Rprivate/fancy_plot_surv.R')#
#
pdf('/Users/boehringer/Desktop/irs.pdf', pointsize=18)#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~gruppe+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung", xmax=365)#
dev.off()#
#
#
#
#
#
#
#
#
d2=read.delim('/Users/boehringer/Documents/Dienstleistung/heinzelmann/fuchssurv.txt')#
source('/Users/boehringer/src/Rprivate/fancy_plot_surv.R')#
d2=subset(d2, KaplanMeierZeit>0)#
d2$Gruppe=as.factor(d2$group)#
levels(d2$Gruppe)=c("pKp","DSAEK")#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~ Gruppe, data=d2), xlab="Tage seit Operation", ylab="Anteil ohne Transplantatversagung und Abstoßung" )#
#
#
#
#
#
#
d0=read.delim('/Users/boehringer/Documents/Dienstleistung/birn/femto/femtolast_090908.txt')#
library(ggplot2)#
library(Hmisc)#
library(car)#
#
d0[!is.na(d0$cyl_k) & d0$cyl_k>0,]$cyl_k= -d0[!is.na(d0$cyl_k) & d0$cyl_k>0,]$cyl_k#
d0[!is.na(d0$kera3mm) & d0$kera3mm >0,]$kera3mm = -d0[!is.na(d0$kera3mm) & d0$kera3mm >0,]$kera3mm#
#
d1=subset(d0, monthspostop>=0 & monthspostop< 12 & indikation %in% c("FD", "BK", "KK") & (hh_ring=="" | hh_ring=="0"))#
d1$x=cut2(d1$monthspostop,c(0,2,5,11))#
levels(d1$x)=c("Quartal 1", "Quartal 2","Quartale 3-4")#
#
d1$x2=cut2(d1$monthspostop,c(0,5))#
levels(d1$x2)=c("Monate 1-6", "Ab Monat 7")#
#
d1$logMAR=-log(d1$bcva, base=10)#
#
pdf('/Users/boehringer/Desktop/ausw_bir_visus.pdf', pointsize=16)#
qplot(x, logMAR, geom="boxplot", data=na.omit(subset(d1, select=c("logMAR","x","gruppe","indikation"))), xlab="Postoperative Zeit", colour= gruppe , facets=indikation~., ylim=c(0,2))#
dev.off()
pdf('/Users/boehringer/Desktop/irs.pdf', pointsize=18)#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~gruppe+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung")#
dev.off()
#
pdf('/Users/boehringer/Desktop/irs.pdf', pointsize=18)#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~gruppe+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung", xmax=365*2)#
dev.off()
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~profile+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung", xmax=365*2)
pdf('/Users/boehringer/Desktop/irs.pdf', pointsize=18)#
plot.survival.fancy(survfit(Surv(KaplanMeierZeit,  KaplanMeierStatus)~profile+strata(indikation), data=d2), plot.CI=F, xlab="Tage seit Keratoplastik", ylab="Anteil ohne Abstoßung", xmax=365*2)#
dev.off()
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/anton/lebensqualitaet.txt")
melt(d0, id.vars=c("Gruppe","ID"))
d0=read.delim("/Users/boehringer/Documents/Dienstleistung/anton/lebensqualitaet.txt")
melt(d0, id.vars=c("Gruppe","ID","mode"))
?merge
merge(d0,d0, by=ID)
d1=melt(d0, id.vars=c("Gruppe","ID","mode"))
merge(d1,d1, by=ID)
d1
summary(d1)
merge(d1,d1, by="ID")
merge(d1,d1, by=c("ID","variable")
)
subset (merge(d1,d1, by=c("ID","variable")), )
subset (merge(d1,d1, by=c("ID","variable")), mode.x="praeop" & mode.y="postop")
subset (merge(d1,d1, by=c("ID","variable")), mode.x=="praeop" & mode.y=="postop")
d2=subset (merge(d1,d1, by=c("ID","variable")), mode.x=="praeop" & mode.y=="postop", select=c(ID, variable, Gruppe.x, value.x, value.y))
d2
d2$change= value.x-value.y
d2$change= d2$value.x-d2$value.y
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2)
summary(d2)
d2
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2, ylim=c(-100,100))
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2, ylim=c(-100,100), ylab="Score Präop- postop")+ opts(axis.title.y = theme_text(size = 18, angle=90, hjust=0.25, vjust=0.3) ))
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2, ylim=c(-100,100), ylab="Score Präop- postop")+ opts(axis.title.y = theme_text(size = 18, angle=90, hjust=0.25, vjust=0.3) )
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2, ylim=c(-100,100), ylab="Score Präop- postop")+ opts(axis.title.y = theme_text(size = 18, angle=45, hjust=0.25, vjust=0.3) )
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2, ylim=c(-100,100), ylab="Score Präop- postop")+ opts(axis.title.x = theme_text(size = 18, angle=90, hjust=0.25, vjust=0.3) )
qplot(variable, change, colour=Gruppe.x, geom=c("boxplot"), data=d2, ylim=c(-100,100), ylab="Score Präop- postop")+ opts(axis.text.x = theme_text(size = 8, angle=45, hjust=1, vjust=0.5), axis.title.x=theme_blank() )
23%12
23 %% 12
View(`d3`)
View(`d1`)
View(`d2`)
View(`d4`)
View(`d6`)
View(v)
View(u)
